{"version":3,"file":"workbox-google-analytics.prod.v2.1.1.js","sources":["../../src/lib/constants.js","../../../../node_modules/idb/lib/idb.js","../../../../lib/idb-helper.js","../../src/lib/enqueue-request.js","../../../../lib/log-group.js","../../../../lib/environment.js","../../../../lib/log-helper.js","../../src/lib/replay-queued-requests.js","../../src/index.js"],"sourcesContent":["/*\n Copyright 2016 Google Inc. All Rights Reserved.\n Licensed under the Apache License, Version 2.0 (the \"License\");\n you may not use this file except in compliance with the License.\n You may obtain a copy of the License at\n\n     http://www.apache.org/licenses/LICENSE-2.0\n\n Unless required by applicable law or agreed to in writing, software\n distributed under the License is distributed on an \"AS IS\" BASIS,\n WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n See the License for the specific language governing permissions and\n limitations under the License.\n*/\n\nexport default {\n  CACHE_NAME: 'offline-google-analytics',\n  IDB: {\n    NAME: 'offline-google-analytics',\n    STORE: 'urls',\n    VERSION: 1,\n  },\n  MAX_ANALYTICS_BATCH_SIZE: 20,\n  STOP_RETRYING_AFTER: 1000 * 60 * 60 * 48, // Two days, in milliseconds.\n  URL: {\n    ANALYTICS_JS_PATH: '/analytics.js',\n    COLLECT_PATH: '/collect',\n    HOST: 'www.google-analytics.com',\n  },\n};\n","'use strict';\n\n(function() {\n  function toArray(arr) {\n    return Array.prototype.slice.call(arr);\n  }\n\n  function promisifyRequest(request) {\n    return new Promise(function(resolve, reject) {\n      request.onsuccess = function() {\n        resolve(request.result);\n      };\n\n      request.onerror = function() {\n        reject(request.error);\n      };\n    });\n  }\n\n  function promisifyRequestCall(obj, method, args) {\n    var request;\n    var p = new Promise(function(resolve, reject) {\n      request = obj[method].apply(obj, args);\n      promisifyRequest(request).then(resolve, reject);\n    });\n\n    p.request = request;\n    return p;\n  }\n\n  function promisifyCursorRequestCall(obj, method, args) {\n    var p = promisifyRequestCall(obj, method, args);\n    return p.then(function(value) {\n      if (!value) return;\n      return new Cursor(value, p.request);\n    });\n  }\n\n  function proxyProperties(ProxyClass, targetProp, properties) {\n    properties.forEach(function(prop) {\n      Object.defineProperty(ProxyClass.prototype, prop, {\n        get: function() {\n          return this[targetProp][prop];\n        },\n        set: function(val) {\n          this[targetProp][prop] = val;\n        }\n      });\n    });\n  }\n\n  function proxyRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function proxyMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return this[targetProp][prop].apply(this[targetProp], arguments);\n      };\n    });\n  }\n\n  function proxyCursorRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyCursorRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function Index(index) {\n    this._index = index;\n  }\n\n  proxyProperties(Index, '_index', [\n    'name',\n    'keyPath',\n    'multiEntry',\n    'unique'\n  ]);\n\n  proxyRequestMethods(Index, '_index', IDBIndex, [\n    'get',\n    'getKey',\n    'getAll',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(Index, '_index', IDBIndex, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  function Cursor(cursor, request) {\n    this._cursor = cursor;\n    this._request = request;\n  }\n\n  proxyProperties(Cursor, '_cursor', [\n    'direction',\n    'key',\n    'primaryKey',\n    'value'\n  ]);\n\n  proxyRequestMethods(Cursor, '_cursor', IDBCursor, [\n    'update',\n    'delete'\n  ]);\n\n  // proxy 'next' methods\n  ['advance', 'continue', 'continuePrimaryKey'].forEach(function(methodName) {\n    if (!(methodName in IDBCursor.prototype)) return;\n    Cursor.prototype[methodName] = function() {\n      var cursor = this;\n      var args = arguments;\n      return Promise.resolve().then(function() {\n        cursor._cursor[methodName].apply(cursor._cursor, args);\n        return promisifyRequest(cursor._request).then(function(value) {\n          if (!value) return;\n          return new Cursor(value, cursor._request);\n        });\n      });\n    };\n  });\n\n  function ObjectStore(store) {\n    this._store = store;\n  }\n\n  ObjectStore.prototype.createIndex = function() {\n    return new Index(this._store.createIndex.apply(this._store, arguments));\n  };\n\n  ObjectStore.prototype.index = function() {\n    return new Index(this._store.index.apply(this._store, arguments));\n  };\n\n  proxyProperties(ObjectStore, '_store', [\n    'name',\n    'keyPath',\n    'indexNames',\n    'autoIncrement'\n  ]);\n\n  proxyRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'put',\n    'add',\n    'delete',\n    'clear',\n    'get',\n    'getAll',\n    'getKey',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  proxyMethods(ObjectStore, '_store', IDBObjectStore, [\n    'deleteIndex'\n  ]);\n\n  function Transaction(idbTransaction) {\n    this._tx = idbTransaction;\n    this.complete = new Promise(function(resolve, reject) {\n      idbTransaction.oncomplete = function() {\n        resolve();\n      };\n      idbTransaction.onerror = function() {\n        reject(idbTransaction.error);\n      };\n      idbTransaction.onabort = function() {\n        reject(idbTransaction.error);\n      };\n    });\n  }\n\n  Transaction.prototype.objectStore = function() {\n    return new ObjectStore(this._tx.objectStore.apply(this._tx, arguments));\n  };\n\n  proxyProperties(Transaction, '_tx', [\n    'objectStoreNames',\n    'mode'\n  ]);\n\n  proxyMethods(Transaction, '_tx', IDBTransaction, [\n    'abort'\n  ]);\n\n  function UpgradeDB(db, oldVersion, transaction) {\n    this._db = db;\n    this.oldVersion = oldVersion;\n    this.transaction = new Transaction(transaction);\n  }\n\n  UpgradeDB.prototype.createObjectStore = function() {\n    return new ObjectStore(this._db.createObjectStore.apply(this._db, arguments));\n  };\n\n  proxyProperties(UpgradeDB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(UpgradeDB, '_db', IDBDatabase, [\n    'deleteObjectStore',\n    'close'\n  ]);\n\n  function DB(db) {\n    this._db = db;\n  }\n\n  DB.prototype.transaction = function() {\n    return new Transaction(this._db.transaction.apply(this._db, arguments));\n  };\n\n  proxyProperties(DB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(DB, '_db', IDBDatabase, [\n    'close'\n  ]);\n\n  // Add cursor iterators\n  // TODO: remove this once browsers do the right thing with promises\n  ['openCursor', 'openKeyCursor'].forEach(function(funcName) {\n    [ObjectStore, Index].forEach(function(Constructor) {\n      Constructor.prototype[funcName.replace('open', 'iterate')] = function() {\n        var args = toArray(arguments);\n        var callback = args[args.length - 1];\n        var nativeObject = this._store || this._index;\n        var request = nativeObject[funcName].apply(nativeObject, args.slice(0, -1));\n        request.onsuccess = function() {\n          callback(request.result);\n        };\n      };\n    });\n  });\n\n  // polyfill getAll\n  [Index, ObjectStore].forEach(function(Constructor) {\n    if (Constructor.prototype.getAll) return;\n    Constructor.prototype.getAll = function(query, count) {\n      var instance = this;\n      var items = [];\n\n      return new Promise(function(resolve) {\n        instance.iterateCursor(query, function(cursor) {\n          if (!cursor) {\n            resolve(items);\n            return;\n          }\n          items.push(cursor.value);\n\n          if (count !== undefined && items.length == count) {\n            resolve(items);\n            return;\n          }\n          cursor.continue();\n        });\n      });\n    };\n  });\n\n  var exp = {\n    open: function(name, version, upgradeCallback) {\n      var p = promisifyRequestCall(indexedDB, 'open', [name, version]);\n      var request = p.request;\n\n      request.onupgradeneeded = function(event) {\n        if (upgradeCallback) {\n          upgradeCallback(new UpgradeDB(request.result, event.oldVersion, request.transaction));\n        }\n      };\n\n      return p.then(function(db) {\n        return new DB(db);\n      });\n    },\n    delete: function(name) {\n      return promisifyRequestCall(indexedDB, 'deleteDatabase', [name]);\n    }\n  };\n\n  if (typeof module !== 'undefined') {\n    module.exports = exp;\n    module.exports.default = module.exports;\n  }\n  else {\n    self.idb = exp;\n  }\n}());\n","/*\n Copyright 2016 Google Inc. All Rights Reserved.\n Licensed under the Apache License, Version 2.0 (the \"License\");\n you may not use this file except in compliance with the License.\n You may obtain a copy of the License at\n\n     http://www.apache.org/licenses/LICENSE-2.0\n\n Unless required by applicable law or agreed to in writing, software\n distributed under the License is distributed on an \"AS IS\" BASIS,\n WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n See the License for the specific language governing permissions and\n limitations under the License.\n*/\n\n/* eslint-disable require-jsdoc */\n\nimport idb from 'idb';\n\n/**\n * A wrapper to store for an IDB connection to a particular ObjectStore.\n *\n * @private\n */\nclass IDBHelper {\n  constructor(name, version, storeName) {\n    if (name == undefined || version == undefined || storeName == undefined) {\n      throw Error('name, version, storeName must be passed to the ' +\n        'constructor.');\n    }\n\n    this._name = name;\n    this._version = version;\n    this._storeName = storeName;\n  }\n\n  /**\n   * Returns a promise that resolves with an open connection to IndexedDB,\n   * either existing or newly opened.\n   *\n   * @private\n   * @return {Promise<DB>}\n   */\n  _getDb() {\n    if (this._dbPromise) {\n      return this._dbPromise;\n    }\n\n    this._dbPromise = idb.open(this._name, this._version, (upgradeDB) => {\n      upgradeDB.createObjectStore(this._storeName);\n    })\n    .then((db) => {\n      return db;\n    });\n\n    return this._dbPromise;\n  }\n\n  close() {\n    if (!this._dbPromise) {\n      return;\n    }\n\n    return this._dbPromise\n    .then((db) => {\n      db.close();\n      this._dbPromise = null;\n    });\n  }\n\n  /**\n   * Wrapper on top of the idb wrapper, which simplifies saving the key/value\n   * pair to the object store.\n   * Returns a Promise that fulfills when the transaction completes.\n   *\n   * @private\n   * @param {String} key\n   * @param {Object} value\n   * @return {Promise<T>}\n   */\n  put(key, value) {\n    return this._getDb().then((db) => {\n      const tx = db.transaction(this._storeName, 'readwrite');\n      const objectStore = tx.objectStore(this._storeName);\n      objectStore.put(value, key);\n      return tx.complete;\n    });\n  }\n\n  /**\n   * Wrapper on top of the idb wrapper, which simplifies deleting an entry\n   * from the object store.\n   * Returns a Promise that fulfills when the transaction completes.\n   *\n   * @private\n   * @param {String} key\n   * @return {Promise<T>}\n   */\n  delete(key) {\n    return this._getDb().then((db) => {\n      const tx = db.transaction(this._storeName, 'readwrite');\n      const objectStore = tx.objectStore(this._storeName);\n      objectStore.delete(key);\n      return tx.complete;\n    });\n  }\n\n  /**\n   * Wrapper on top of the idb wrapper, which simplifies getting a key's value\n   * from the object store.\n   * Returns a promise that fulfills with the value.\n   *\n   * @private\n   * @param {String} key\n   * @return {Promise<Object>}\n   */\n  get(key) {\n    return this._getDb().then((db) => {\n      return db.transaction(this._storeName)\n        .objectStore(this._storeName)\n        .get(key);\n    });\n  }\n\n  /**\n   * Wrapper on top of the idb wrapper, which simplifies getting all the values\n   * in an object store.\n   * Returns a promise that fulfills with all the values.\n   *\n   * @private\n   * @return {Promise<Array<Object>>}\n   */\n  getAllValues() {\n    return this._getDb().then((db) => {\n      return db.transaction(this._storeName)\n        .objectStore(this._storeName)\n        .getAll();\n    });\n  }\n\n  /**\n   * Wrapper on top of the idb wrapper, which simplifies getting all the keys\n   * in an object store.\n   * Returns a promise that fulfills with all the keys.\n   *\n   * @private\n   * @param {String} storeName\n   * @return {Promise<Array<Object>>}\n   */\n  getAllKeys() {\n    return this._getDb().then((db) => {\n      return db.transaction(this._storeName)\n        .objectStore(this._storeName)\n        .getAllKeys();\n    });\n  }\n}\n\nexport default IDBHelper;\n","/*\n Copyright 2016 Google Inc. All Rights Reserved.\n Licensed under the Apache License, Version 2.0 (the \"License\");\n you may not use this file except in compliance with the License.\n You may obtain a copy of the License at\n http://www.apache.org/licenses/LICENSE-2.0\n Unless required by applicable law or agreed to in writing, software\n distributed under the License is distributed on an \"AS IS\" BASIS,\n WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n See the License for the specific language governing permissions and\n limitations under the License.\n */\n\n/* eslint-env worker, serviceworker */\n\nimport IDBHelper from '../../../../lib/idb-helper.js';\nimport constants from './constants.js';\n\nconst idbHelper = new IDBHelper(constants.IDB.NAME, constants.IDB.VERSION,\n  constants.IDB.STORE);\n\n/**\n * Adds a URL to IndexedDB, along with the current timestamp.\n *\n * If the request has a body, that body will be used as the URL's search\n * parameters when saving the URL to IndexedDB.\n *\n * If no `time` parameter is provided, Date.now() will be used.\n *\n * @private\n * @param {Request} request\n*  @param {Number} [time]\n * @return {Promise.<T>} A promise that resolves when IndexedDB is updated.\n */\nexport default (request, time) => {\n  const url = new URL(request.url);\n  return request.text().then((body) => {\n    // If there's a request body, then use it as the URL's search value.\n    // This is most likely because the original request was an HTTP POST\n    // that uses the beacon transport.\n    if (body) {\n      url.search = body;\n    }\n\n    return idbHelper.put(url.toString(), time || Date.now());\n  });\n};\n","/* eslint-disable no-console */\n\n/**\n * A simple helper to manage the print of a set of logs\n */\nclass LogGroup {\n  /**\n   * @param {object} input\n   */\n  constructor() {\n    this._logs = [];\n    this._childGroups = [];\n\n    this._isFallbackMode = false;\n    const ffRegex = /Firefox\\/(\\d*)\\.\\d*/.exec(navigator.userAgent);\n    if (ffRegex) {\n      try {\n        const ffVersion = parseInt(ffRegex[1], 10);\n        if (ffVersion < 55) {\n          this._isFallbackMode = true;\n        }\n      } catch (err) {\n        this._isFallbackMode = true;\n      }\n    }\n\n    if (/Edge\\/\\d*\\.\\d*/.exec(navigator.userAgent)) {\n      this._isFallbackMode = true;\n    }\n  }\n\n  /**\n   *@param {object} logDetails\n   */\n  addPrimaryLog(logDetails) {\n    this._primaryLog = logDetails;\n  }\n\n  /**\n   *@param {object} logDetails\n   */\n  addLog(logDetails) {\n    this._logs.push(logDetails);\n  }\n\n  /**\n   * @param {object} group\n   */\n  addChildGroup(group) {\n    if (group._logs.length === 0) {\n      return;\n    }\n\n    this._childGroups.push(group);\n  }\n\n  /**\n   * prints out this log group to the console.\n   */\n  print() {\n    if (this._logs.length === 0 && this._childGroups.length === 0) {\n      this._printLogDetails(this._primaryLog);\n      return;\n    }\n\n    if (this._primaryLog) {\n      if (!this._isFallbackMode) {\n        console.groupCollapsed(...this._getLogContent(this._primaryLog));\n      } else {\n        this._printLogDetails(this._primaryLog);\n      }\n    }\n\n    this._logs.forEach((logDetails) => {\n      this._printLogDetails(logDetails);\n    });\n\n    this._childGroups.forEach((group) => {\n      group.print();\n    });\n\n    if (this._primaryLog && !this._isFallbackMode) {\n      console.groupEnd();\n    }\n  }\n\n  /**\n   * Prints the specific logDetails object.\n   * @param {object} logDetails\n   */\n  _printLogDetails(logDetails) {\n    const logFunc = logDetails.logFunc ? logDetails.logFunc : console.log;\n    logFunc(...this._getLogContent(logDetails));\n  }\n\n  /**\n   * Returns a flattened array of message with colors and args.\n   * @param {object} logDetails\n   * @return {Array} Returns an array of arguments to pass to a console\n   * function.\n   */\n  _getLogContent(logDetails) {\n    let message = logDetails.message;\n    if (this._isFallbackMode && typeof message === 'string') {\n      // Replace the %c value with an empty string.\n      message = message.replace(/%c/g, '');\n    }\n\n    let allArguments = [message];\n\n    if (!this._isFallbackMode && logDetails.colors) {\n      allArguments = allArguments.concat(logDetails.colors);\n    }\n\n    if (logDetails.args) {\n      allArguments = allArguments.concat(logDetails.args);\n    }\n    return allArguments;\n  }\n}\n\nexport default LogGroup;\n","/*\n Copyright 2016 Google Inc. All Rights Reserved.\n Licensed under the Apache License, Version 2.0 (the \"License\");\n you may not use this file except in compliance with the License.\n You may obtain a copy of the License at\n\n     http://www.apache.org/licenses/LICENSE-2.0\n\n Unless required by applicable law or agreed to in writing, software\n distributed under the License is distributed on an \"AS IS\" BASIS,\n WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n See the License for the specific language governing permissions and\n limitations under the License.\n*/\n\n/**\n * @private\n * @return {boolean} True, if we're running in the service worker global scope.\n * False otherwise.\n */\nexport function isServiceWorkerGlobalScope() {\n  return ('ServiceWorkerGlobalScope' in self &&\n          self instanceof ServiceWorkerGlobalScope);\n}\n\n/**\n * @private\n * @return {boolean} True, if we're running a development bundle.\n * False otherwise.\n */\nexport function isDevBuild() {\n  // `BUILD_PROCESS_REPLACE::BUILD_TARGET` is replaced during the build process.\n  return `BUILD_PROCESS_REPLACE::BUILD_TARGET` === `dev`;\n}\n\n/**\n * @private\n * @return {boolean} True, if we're running on localhost or the equivalent IP\n * address. False otherwise.\n */\nexport function isLocalhost() {\n  return Boolean(\n    location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n  );\n}\n","/*\n Copyright 2016 Google Inc. All Rights Reserved.\n Licensed under the Apache License, Version 2.0 (the \"License\");\n you may not use this file except in compliance with the License.\n You may obtain a copy of the License at\n\n     http://www.apache.org/licenses/LICENSE-2.0\n\n Unless required by applicable law or agreed to in writing, software\n distributed under the License is distributed on an \"AS IS\" BASIS,\n WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n See the License for the specific language governing permissions and\n limitations under the License.\n*/\n\n/* eslint-disable no-console */\n\nimport LogGroup from './log-group';\nimport {isDevBuild} from './environment';\n\nself.workbox = self.workbox || {};\nself.workbox.LOG_LEVEL = self.workbox.LOG_LEVEL || {\n  none: -1,\n  verbose: 0,\n  debug: 1,\n  warn: 2,\n  error: 3,\n};\n\nconst LIGHT_GREY = `#bdc3c7`;\nconst DARK_GREY = `#7f8c8d`;\nconst LIGHT_GREEN = `#2ecc71`;\nconst LIGHT_YELLOW = `#f1c40f`;\nconst LIGHT_RED = `#e74c3c`;\nconst LIGHT_BLUE = `#3498db`;\n\n/**\n * A class that will only log given the current log level\n * defined by the developer.\n *\n * Define custom log level by setting `self.workbox.logLevel`.\n *\n * @example\n *\n * self.workbox.logLevel = self.workbox.LOG_LEVEL.verbose;\n *\n * @private\n */\nclass LogHelper {\n  /**\n   * LogHelper constructor.\n   */\n  constructor() {\n    this._defaultLogLevel = isDevBuild() ?\n      self.workbox.LOG_LEVEL.debug :\n      self.workbox.LOG_LEVEL.warn;\n  }\n\n  /**\n   * The most verbose log level.\n   *\n   * @param {Object} options The options of the log.\n   */\n  log(options) {\n    this._printMessage(self.workbox.LOG_LEVEL.verbose, options);\n  }\n\n  /**\n   * Useful for logs that are more exceptional that log()\n   * but not severe.\n   *\n   * @param {Object} options The options of the log.\n   */\n  debug(options) {\n    this._printMessage(self.workbox.LOG_LEVEL.debug, options);\n  }\n\n  /**\n   * Warning messages.\n   *\n   * @param {Object} options The options of the log.\n   */\n  warn(options) {\n    this._printMessage(self.workbox.LOG_LEVEL.warn, options);\n  }\n\n  /**\n   * Error logs.\n   *\n   * @param {Object} options The options of the log.\n   */\n  error(options) {\n    this._printMessage(self.workbox.LOG_LEVEL.error, options);\n  }\n\n  /**\n   * Method to print to the console.\n   * @param {number} logLevel\n   * @param {Object} logOptions\n   */\n  _printMessage(logLevel, logOptions) {\n    if (!this._shouldLogMessage(logLevel, logOptions)) {\n      return;\n    }\n\n    const logGroups = this._getAllLogGroups(logLevel, logOptions);\n    logGroups.print();\n  }\n\n  /**\n   * Print a user friendly log to the console.\n   * @param  {numer} logLevel A number from self.workbox.LOG_LEVEL\n   * @param  {Object} logOptions Arguments to print to the console\n   * @return {LogGroup} Returns a log group to print to the console.\n   */\n  _getAllLogGroups(logLevel, logOptions) {\n    const topLogGroup = new LogGroup();\n\n    const primaryMessage = this._getPrimaryMessageDetails(logLevel, logOptions);\n    topLogGroup.addPrimaryLog(primaryMessage);\n\n    if (logOptions.error) {\n      const errorMessage = {\n        message: logOptions.error,\n        logFunc: console.error,\n      };\n      topLogGroup.addLog(errorMessage);\n    }\n\n    const extraInfoGroup = new LogGroup();\n    if (logOptions.that && logOptions.that.constructor &&\n      logOptions.that.constructor.name) {\n      const className = logOptions.that.constructor.name;\n      extraInfoGroup.addLog(\n        this._getKeyValueDetails('class', className)\n      );\n    }\n\n    if (logOptions.data) {\n      if (typeof logOptions.data === 'object' &&\n        !(logOptions.data instanceof Array)) {\n        Object.keys(logOptions.data).forEach((keyName) => {\n          extraInfoGroup.addLog(\n            this._getKeyValueDetails(keyName, logOptions.data[keyName])\n          );\n        });\n      } else {\n        extraInfoGroup.addLog(\n          this._getKeyValueDetails('additionalData', logOptions.data)\n        );\n      }\n    }\n\n    topLogGroup.addChildGroup(extraInfoGroup);\n\n    return topLogGroup;\n  }\n\n  /**\n   * This is a helper function to wrap key value pairss to a colored key\n   * value string.\n   * @param  {string} key\n   * @param  {string} value\n   * @return {Object} The object containing a message, color and Arguments\n   * for the console.\n   */\n  _getKeyValueDetails(key, value) {\n    return {\n      message: `%c${key}: `,\n      colors: [`color: ${LIGHT_BLUE}`],\n      args: value,\n    };\n  }\n\n  /**\n   * Helper method to color the primary message for the log\n   * @param  {number} logLevel   One of self.workbox.LOG_LEVEL\n   * @param  {Object} logOptions Arguments to print to the console\n   * @return {Object} Object containing the message and color info to print.\n   */\n  _getPrimaryMessageDetails(logLevel, logOptions) {\n    let logLevelName;\n    let logLevelColor;\n    switch (logLevel) {\n      case self.workbox.LOG_LEVEL.verbose:\n        logLevelName = 'Info';\n        logLevelColor = LIGHT_GREY;\n        break;\n      case self.workbox.LOG_LEVEL.debug:\n        logLevelName = 'Debug';\n        logLevelColor = LIGHT_GREEN;\n        break;\n      case self.workbox.LOG_LEVEL.warn:\n        logLevelName = 'Warn';\n        logLevelColor = LIGHT_YELLOW;\n        break;\n      case self.workbox.LOG_LEVEL.error:\n        logLevelName = 'Error';\n        logLevelColor = LIGHT_RED;\n        break;\n    }\n\n    let primaryLogMessage = `%c🔧 %c[${logLevelName}]`;\n    const primaryLogColors = [\n      `color: ${LIGHT_GREY}`,\n      `color: ${logLevelColor}`,\n    ];\n\n    let message;\n    if (typeof logOptions === 'string') {\n      message = logOptions;\n    } else if (logOptions.message) {\n      message = logOptions.message;\n    }\n\n    if (message) {\n      message = message.replace(/\\s+/g, ' ');\n      primaryLogMessage += `%c ${message}`;\n      primaryLogColors.push(`color: ${DARK_GREY}; font-weight: normal`);\n    }\n\n    return {\n      message: primaryLogMessage,\n      colors: primaryLogColors,\n    };\n  }\n\n  /**\n   * Test if the message should actually be logged.\n   * @param {number} logLevel The level of the current log to be printed.\n   * @param {Object|String} logOptions The options to log.\n   * @return {boolean} Returns true of the message should be printed.\n   */\n  _shouldLogMessage(logLevel, logOptions) {\n    if (!logOptions) {\n      return false;\n    }\n\n    let minValidLogLevel = this._defaultLogLevel;\n    if (self && self.workbox && typeof self.workbox.logLevel === 'number') {\n      minValidLogLevel = self.workbox.logLevel;\n    }\n\n    if (minValidLogLevel === self.workbox.LOG_LEVEL.none ||\n      logLevel < minValidLogLevel) {\n      return false;\n    }\n\n    return true;\n  }\n}\n\nexport default new LogHelper();\n","/*\n Copyright 2016 Google Inc. All Rights Reserved.\n Licensed under the Apache License, Version 2.0 (the \"License\");\n you may not use this file except in compliance with the License.\n You may obtain a copy of the License at\n http://www.apache.org/licenses/LICENSE-2.0\n Unless required by applicable law or agreed to in writing, software\n distributed under the License is distributed on an \"AS IS\" BASIS,\n WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n See the License for the specific language governing permissions and\n limitations under the License.\n */\n\n/* eslint-env worker, serviceworker */\n\nimport IDBHelper from '../../../../lib/idb-helper.js';\nimport constants from './constants.js';\n\nconst idbHelper = new IDBHelper(constants.IDB.NAME, constants.IDB.VERSION,\n  constants.IDB.STORE);\n\n/**\n * Replays all the queued requests found in IndexedDB, by calling fetch()\n * with an additional parameter indicating the offset from the original time.\n *\n * Returns a promise that resolves when the replaying is complete.\n *\n * @private\n * @param {Object=}   config Optional configuration arguments.\n * @param {Object=}   config.parameterOverrides Optional\n *                    [Measurement Protocol parameters](https://developers.google.com/analytics/devguides/collection/protocol/v1/parameters),\n *                    expressed as key/value pairs, to be added to replayed\n *                    Google Analytics requests. This can be used to, e.g., set\n *                    a custom dimension indicating that the request was\n *                    replayed.\n * @param {Function=} config.hitFilter Optional\n *                    A function that allows you to modify the hit parameters\n *                    prior to replaying the hit. The function is invoked with\n *                    the original hit's URLSearchParams object as its only\n *                    argument. To abort the hit and prevent it from being\n *                    replayed, throw an error.\n * @return {Promise.<T>}\n */\n export default (config) => {\n  config = config || {};\n\n  return idbHelper.getAllKeys().then((urls) => {\n    return Promise.all(urls.map((url) => {\n      return idbHelper.get(url).then((hitTime) => {\n        const queueTime = Date.now() - hitTime;\n        const newUrl = new URL(url);\n\n        // Do not attempt to replay hits that are too old.\n        if (queueTime > constants.STOP_RETRYING_AFTER) {\n          return;\n        }\n\n        // Do not attempt to replay hits in browsers without\n        // URLSearchParams support.\n        if (!('searchParams' in newUrl)) {\n          return;\n        }\n\n        let parameterOverrides = config.parameterOverrides || {};\n        parameterOverrides.qt = queueTime;\n\n        // Call sort() on the keys so that there's a reliable order of calls\n        // to searchParams.set(). This isn't important in terms of\n        // functionality, but it will make testing easier, since the\n        // URL serialization depends on the order in which .set() is called.\n        Object.keys(parameterOverrides).sort().forEach((parameter) => {\n          newUrl.searchParams.set(parameter, parameterOverrides[parameter]);\n        });\n\n        // If the hitFilter config option was passed and is a function,\n        // invoke it with searchParams as its argument allowing the function\n        // to modify the hit prior to sending it. The function can also\n        // throw an error to abort the hit if needed.\n        let hitFilter = config.hitFilter;\n        if (typeof hitFilter === 'function') {\n          try {\n            hitFilter(newUrl.searchParams);\n          } catch (err) {\n            return;\n          }\n        }\n\n        return fetch(newUrl.toString());\n      }).then(() => idbHelper.delete(url));\n    }));\n  });\n};\n","/*\n Copyright 2016 Google Inc. All Rights Reserved.\n Licensed under the Apache License, Version 2.0 (the \"License\");\n you may not use this file except in compliance with the License.\n You may obtain a copy of the License at\n http://www.apache.org/licenses/LICENSE-2.0\n Unless required by applicable law or agreed to in writing, software\n distributed under the License is distributed on an \"AS IS\" BASIS,\n WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n See the License for the specific language governing permissions and\n limitations under the License.\n */\n\n/* eslint-env worker, serviceworker */\n\nimport constants from './lib/constants.js';\nimport enqueueRequest from './lib/enqueue-request.js';\nimport logHelper from '../../../lib/log-helper.js';\nimport replayQueuedRequests from './lib/replay-queued-requests.js';\n\n/**\n * In order to use the library, call\n * `workbox.googleAnalytics.initialize()`.\n * It will take care of setting up service worker `fetch` handlers to ensure\n * that the Google Analytics JavaScript is available offline, and that any\n * Google Analytics requests made while offline are saved (using `IndexedDB`)\n * and retried the next time the service worker starts up.\n *\n * @example\n * // This code should live inside your service worker JavaScript, ideally\n * // before any other 'fetch' event handlers are defined:\n *\n * // First, import the library into the service worker global scope:\n * importScripts('path/to/offline-google-analytics-import.js');\n *\n * // Then, call workbox.googleAnalytics.initialize():\n * workbox.googleAnalytics.initialize();\n *\n * // At this point, implement any other service worker caching strategies\n * // appropriate for your web app.\n *\n * @example\n * // If you need to specify parameters to be sent with each hit, you can use\n * // the `parameterOverrides` configuration option. This is useful in cases\n * // where you want to set a custom dimension on all hits sent by the service\n * // worker to differentiate them in your reports later.\n * workbox.googleAnalytics.initialize({\n *   parameterOverrides: {\n *     cd1: 'replay'\n *   }\n * });\n *\n * @example\n * // In situations where you need to programmatically modify a hit's\n * // parameters you can use the `hitFilter` option. One example of when this\n * // might be useful is if you wanted to track the amount of time that elapsed\n * // between when the hit was attempted and when it was successfully replayed.\n * workbox.googleAnalytics.initialize({\n *   hitFilter: searchParams => {\n *     // Sets the `qt` param as a custom metric.\n *     const qt = searchParams.get('qt');\n *     searchParams.set('cm1', qt);\n *   }\n * });\n *\n * @module workbox-google-analytics\n */\n\n/**\n * @param {Object=}   config\n * @param {Object=}   config.parameterOverrides\n *                    [Measurement Protocol parameters](https://developers.google.com/analytics/devguides/collection/protocol/v1/parameters),\n *                    expressed as key/value pairs, to be added to replayed\n *                    Google Analytics requests. This can be used to, e.g., set\n *                    a custom dimension indicating that the request was\n *                    replayed.\n * @param {Function=} config.hitFilter\n *                    A function that allows you to modify the hit parameters\n *                    prior to replaying the hit. The function is invoked with\n *                    the original hit's URLSearchParams object as its only\n *                    argument. To abort the hit and prevent it from being\n *                    replayed, throw an error.\n * @memberof module:workbox-google-analytics\n */\nconst initialize = (config) => {\n  config = config || {};\n\n  // Stores whether or not the previous /collect request failed.\n  let previousHitFailed = false;\n\n  self.addEventListener('fetch', (event) => {\n    const url = new URL(event.request.url);\n    const request = event.request;\n\n    if (url.hostname === constants.URL.HOST) {\n      if (url.pathname === constants.URL.COLLECT_PATH) {\n        // If this is a /collect request, then use a network-first strategy,\n        // falling back to queueing the request in IndexedDB.\n\n        // Make a clone of the request before we use it, in case we need\n        // to read the request body later on.\n        const clonedRequest = request.clone();\n\n        event.respondWith(\n          fetch(request).then((response) => {\n            if (previousHitFailed) {\n              replayQueuedRequests(config);\n            }\n            previousHitFailed = false;\n            return response;\n          }, (error) => {\n            logHelper.log('Enqueuing failed request...');\n            previousHitFailed = true;\n            return enqueueRequest(clonedRequest).then(() => Response.error());\n          })\n        );\n      } else if (url.pathname === constants.URL.ANALYTICS_JS_PATH) {\n        // If this is a request for the Google Analytics JavaScript library,\n        // use the network first, falling back to the previously cached copy.\n        event.respondWith(\n          caches.open(constants.CACHE_NAME).then((cache) => {\n            return fetch(request).then((response) => {\n              return cache.put(request, response.clone()).then(() => response);\n            }).catch((error) => {\n              logHelper.error(error);\n              return cache.match(request);\n            });\n          })\n        );\n      }\n    }\n  });\n\n  replayQueuedRequests(config);\n};\n\nexport default {initialize};\n"],"names":["CACHE_NAME","IDB","NAME","STORE","VERSION","MAX_ANALYTICS_BATCH_SIZE","STOP_RETRYING_AFTER","URL","ANALYTICS_JS_PATH","COLLECT_PATH","HOST","prototype","slice","call","onsuccess","result","onerror","error","apply","then","request","forEach","Object","defineProperty","get","set","arguments","_index","_cursor","_request","_store","_tx","complete","oncomplete","onabort","_db","oldVersion","transaction","IDBIndex","IDBCursor","resolve","createIndex","index","IDBObjectStore","objectStore","IDBTransaction","createObjectStore","IDBDatabase","replace","length","getAll","iterateCursor","push","value","continue","open","indexedDB","onupgradeneeded","delete","exports","constructor","_name","_version","_storeName","_getDb","_dbPromise","idb","close","put","getAllValues","getAllKeys","constants","url","text","search","idbHelper","toString","Date","now","_logs","_childGroups","_isFallbackMode","exec","navigator","userAgent","parseInt","addPrimaryLog","_primaryLog","addLog","addChildGroup","print","_printLogDetails","console","groupCollapsed","_getLogContent","groupEnd","logFunc","log","message","colors","concat","args","self","workbox","LOG_LEVEL","none","verbose","debug","warn","DARK_GREY","LIGHT_GREEN","LIGHT_YELLOW","LIGHT_RED","LIGHT_BLUE","_defaultLogLevel","isDevBuild","_printMessage","_shouldLogMessage","_getAllLogGroups","_getPrimaryMessageDetails","that","name","_getKeyValueDetails","data","keys","LIGHT_GREY","logLevel","Promise","all","map","parameterOverrides","qt","sort","searchParams","hitFilter","addEventListener","hostname","pathname","clone","respondWith","fetch","replayQueuedRequests","logHelper","enqueueRequest","Response","caches","catch","match","initialize"],"mappings":"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"}